# =============================================================================
# OpenClaw BFF - Local .env (infra-compatible)
# =============================================================================
# Questo file Ã¨ compatibile con:
# - docker-compose.infra.yml (Postgres/MinIO/Keycloak su HOST)
# - scripts/init_*.sh (creano gli stessi nomi/credenziali qui sotto)
#
# Posizione: metti questo file come `openclaw-bff/.env`
# =============================================================================

# ---------------------------
# Backend (FastAPI / Uvicorn)
# ---------------------------
BFF_PORT=8000
BFF_LOG_LEVEL=info
BFF_ENV=local
# CORS (comma-separated). In dev puoi usare "*"
BFF_CORS_ORIGINS=*

# ---------------------------
# Auth (Keycloak) - DISATTIVABILE
# ---------------------------
# false = bypass JWT; usa X-Debug-User oppure DEV_USER_ID
# true  = valida JWT via JWKS Keycloak
KEYCLOAK_ENABLED=false

# Base URL Keycloak (compose espone 8080 su host)
KEYCLOAK_BASE_URL=http://localhost:8080
KEYCLOAK_REALM=openclaw-bff
KEYCLOAK_CLIENT_ID=openclaw-bff-api

# Credenziali admin usate dallo script init_keycloak.sh
KEYCLOAK_ADMIN_USER=admin
KEYCLOAK_ADMIN_PASSWORD=admin

# Utente di test creato da init_keycloak.sh (usato dai test pytest quando KEYCLOAK_ENABLED=true)
KEYCLOAK_TEST_USER=testuser
KEYCLOAK_TEST_PASSWORD=testpassword

# Quando KEYCLOAK_ENABLED=false:
DEV_USER_ID=dev-user

# ---------------------------
# PostgreSQL (compose espone 5432 su host)
# ---------------------------
# Creati da scripts/init_db.sh
BFF_DB_HOST=localhost
BFF_DB_PORT=5432
BFF_DB_NAME=openclaw_bff
BFF_DB_USER=openclaw_bff
BFF_DB_PASSWORD=openclaw_bff

# SQLAlchemy async URL (se il backend la usa direttamente)
DATABASE_URL=postgresql+asyncpg://openclaw_bff:openclaw_bff@localhost:5432/openclaw_bff

# Superuser usato dal compose (utile solo se vuoi riusare gli script con override)
POSTGRES_SUPERUSER=postgres
POSTGRES_SUPERPASS=postgres
POSTGRES_SUPERDB=postgres

# ---------------------------
# MinIO (compose espone 9000/9001 su host)
# ---------------------------
MINIO_ENDPOINT=http://localhost:9000
MINIO_CONSOLE=http://localhost:9001
MINIO_BUCKET=openclaw-bff

# Root creds del compose (solo per init_minio.sh)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# Credenziali applicative create da init_minio.sh (backend le usa)
MINIO_BFF_ACCESS_KEY=openclaw-bff
MINIO_BFF_SECRET_KEY=openclaw-bff-secret

# Presigned URL expiry (secondi)
MINIO_PRESIGN_EXPIRE_SECONDS=3600

# ---------------------------
# OpenClaw (gira su HOST) - DA ADEGUARE ALLA TUA INSTALLAZIONE
# ---------------------------
# Imposta qui la base URL HTTP del Gateway OpenClaw e la URL WS RPC.
# Esempi comuni (modifica se diverso):
OPENCLAW_HTTP_BASE=http://localhost:3210
OPENCLAW_WS_URL=ws://localhost:3210/ws

# Token del gateway (se hai auth token). Se non usi token, lascia vuoto.
OPENCLAW_GATEWAY_TOKEN=

# WS Device Identity (se il tuo setup WS richiede firma device)
# Se il backend usa device-signing, compila questi campi.
OPENCLAW_DEVICE_ID=
# Chiave privata Ed25519 in base64 (32 bytes). Generala e incollala qui.
OPENCLAW_DEVICE_PRIVATE_KEY_B64=

# Opzioni di policy lato BFF
BFF_ALLOW_CLIENT_SESSION_KEY=false
BFF_DEFAULT_AGENT_ID=main

# ---------------------------
# Testing
# ---------------------------
BASE_URL=http://localhost:8000
